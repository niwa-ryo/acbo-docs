# コスト考慮型ベイズ最適化手法の比較

## 各手法の概要と特徴

### 1. CArBO (Cost Apportioned BO)
- **核心**: クーリングパラメータλで探索戦略を段階的に切り替え
- **初期**: EIpc的動作（低コスト領域重視）
- **後期**: EI的動作（性能重視）
- **長所**: シンプルな実装、パラメータ調整が直感的
- **短所**: 固定的な切り替えスケジュール、最適解の位置を暗黙に仮定

### 2. ACBO (Adaptive Cost-aware BO)
- **核心**: Multi-Armed Bandit (MAB)でEIとEIpsを動的選択
- **Thompson Sampling**: 各戦略の性能を学習しながら適応
- **長所**: 最適解の位置を事前仮定不要、様々な問題で安定
- **短所**: 複数GPの構築が必要、計算コストがやや高い

### 3. CAStoP (Cost-aware Stopping)
- **核心**: Pandora's Box理論による最適停止戦略
- **Gittins Index**: 各点の「探索価値」を理論的に評価
- **長所**: 無駄な評価を自動削減、理論的保証あり
- **短所**: GP仮定が必要、離散候補点での評価

### 4. PBGI (Pandora's Box Gittins Index)
- **核心**: Pandora's Box理論を獲得関数として活用
- **λパラメータ**: 探索-活用トレードオフを制御
- **長所**: 理論的基盤と計算効率を両立、中高次元で優秀
- **短所**: 相関の仮定が近似的、パラメータ感度（PBGI-Dで緩和）

## 手法の使い分けガイド

### 問題特性による選択

| 状況 | 推奨手法 | 理由 |
|------|---------|------|
| 最適解が低コスト領域と確信 | CArBO | 初期のEIpc的動作が効果的 |
| 最適解の位置が不明 | ACBO | MABによる適応的選択 |
| 評価コストが非常に高い | CAStoP | 自動停止で無駄を削減 |
| 中～高次元問題 | PBGI | 次元の呪いに強い |
| シンプルな実装を優先 | CArBO | パラメータ調整が容易 |

### 計算資源による選択

| 計算資源 | 推奨 | 非推奨 |
|---------|------|--------|
| 限定的 | CArBO, PBGI | ACBO（複数GP） |
| 豊富 | ACBO, CAStoP | - |

## 理論的基盤の比較

| 手法 | 理論基盤 | 最適性保証 |
|------|---------|-----------|
| CArBO | ヒューリスティック | なし |
| ACBO | Thompson Sampling | 収束性あり |
| CAStoP | Pandora's Box | ベイズ最適（離散） |
| PBGI | Pandora's Box + BO | 近似的最適性 |

## 実験結果の要点

### 性能傾向

1. **低次元（d ≤ 4）**: すべての手法がほぼ同等
2. **中次元（d = 8-16）**: PBGI, ACBOが優位
3. **高次元（d ≥ 32）**: PBGIがやや優位、他は劣化

### ベンチマーク別性能

| ベンチマーク | 最良手法 | 次点 |
|-------------|---------|------|
| 多峰性関数 | PBGI, ACBO | CArBO |
| 単峰性関数 | CArBO | PBGI-D |
| 実応用問題 | PBGI | ACBO |

## 今後の研究方向

### 共通の課題
- 連続領域での理論保証の強化
- バッチ評価への拡張
- 非ガウス過程モデルへの適用

### 統合アプローチの可能性
- ACBOの枠組みにPBGIを組み込み
- CAStoPの停止戦略を他手法に適用
- 複数手法のアンサンブル

## まとめ

コスト考慮型ベイズ最適化は、実用上重要な問題設定。各手法は異なる理論的基盤と特徴を持ち、問題の性質に応じて使い分けが重要：

- **CArBO**: シンプルで実用的
- **ACBO**: 適応性が高く汎用的
- **CAStoP**: 停止戦略に特化
- **PBGI**: 理論と実用のバランス

今後は、これらの手法の長所を組み合わせた統合的アプローチの開発が期待される。